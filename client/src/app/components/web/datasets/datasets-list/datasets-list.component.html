<div class="container">
    <h1 translate>TITLE_DATACENTER</h1>
    <div class="ui-g">
        <div *ngIf="selectedSearchOption == 'busqueda-libre'" class="ui-g-8">
            <b class="ui-g-4">DATOS CON EL TEXTO </b>
            <div class="ui-inputgroup">
                <input style="width:500px" type="text" [value]="searchValue" (keyup.enter)="searchDatasetsByText(searchInput.value)" #searchInput>
                <button pButton type="button" icon="fa-search" (click)="searchDatasetsByText(searchInput.value)" class="ui-button-secondary"></button>
            </div>
        </div>
        <div *ngIf="selectedSearchOption == 'buscador-homer'" class="ui-g-8">
            <b>BUSCAR</b>
            <input type="text" [value]="searchHomerValue" [style]="{'width':'200px'}" #searchHomerInput>
            <b>EN</b>
            <p-dropdown [options]="langsSelect" [(ngModel)]="selectedLang" [style]="{'width':'240px'}"></p-dropdown>
            <button type="button"><i aria-hidden="true" class="fa fa-search"></i></button>
        </div>
        <div *ngIf="selectedSearchOption == 'etiquetas'" class="ui-g-8">
            <p-autoComplete [(ngModel)]="tags" [suggestions]="filteredTagsMultiple" (completeMethod)="filterTagsMultiple($event)" [minLength]="1"
                placeholder="Etiquetas" field="name" [multiple]="true">
            </p-autoComplete>
            <button type="button" (click)="getDatasetsByTags()"><i aria-hidden="true" class="fa fa-search"></i></button>
        </div>
        <div *ngIf="selectedSearchOption == 'tema-y-tipo'" class="ui-g-4">
            <b>Datos sobre </b>
            <!-- <p-dropdown [options]="topicsSelect" [(ngModel)]="selectedTopic" [style]="{'width':'200px'}" (onChange)="loadDatasets()"></p-dropdown> -->
            <select class="ui-dropdown-label ui-inputtext ui-corner-all" [(ngModel)]="selectedTopic" (change)="loadDatasets()">
                <option *ngFor="let topSel of topicsSelect" [ngValue]="topSel.value">{{topSel.label}}</option>
              </select>
        </div>
        <div *ngIf="selectedSearchOption == 'organizacion-y-tipo'" class="ui-g-4">
            <b>Datos sobre </b>
            <p-dropdown [options]="orgsSelect" [(ngModel)]="selectedOrg" placeholder="Todas las organizaciones" [style]="{'width':'240px'}"
                (onChange)="searchDatasetsetByOrg()"></p-dropdown>
            <!-- <select class="ui-dropdown-label ui-inputtext ui-corner-all" [(ngModel)]="selectedOrg" [style]="{'width':'200px'}" (change)="searchDatasetsetByOrg()">
                <option *ngFor="let orgs of orgsSelect" [ngValue]="orgs.value">{{orgs.label}}</option>
            </select> -->
        </div>
        <div *ngIf="selectedSearchOption == 'tema-y-tipo' || selectedSearchOption == 'organizacion-y-tipo'" class="ui-g-4">
            <b>Del tipo </b>
            <!-- <p-dropdown [options]="datasetTypes" [(ngModel)]="selectedType" placeholder="Todos los tipos" [style]="{'width':'200px'}"
                (onChange)="changeType()"></p-dropdown> -->
            <select class="ui-dropdown-label ui-inputtext ui-corner-all" [(ngModel)]="selectedType" (change)="changeType()">
                <option *ngFor="let types of datasetTypes" [ngValue]="types.value">{{types.label}}</option>
            </select>
        </div>
        <div class="ui-g-4">
            <p-dropdown [options]="searchOptions" [(ngModel)]="selectedSearchOption" placeholder="Selecciona una búsqueda" (onChange)="resetSearch()"></p-dropdown>
        </div>
    </div>

    <p-dataTable [value]="datasets" [responsive]="true" (onSort)="setOrder($event)" #dt>
        <p-column field="name" header="{{numDatasets}} conjuntos de datos encontrados" sortable="custom" sortFunction="orderTable($event)">
            <ng-template pTemplate="body" let-dataset="rowData">
                <a routerLink='/datos/catalogo/{{dataset.name}}' (click)="showDataset(dataset)">
                        {{dataset.title}}
                    </a>
            </ng-template>
        </p-column>
        <p-column field="accesos" header="Nº de accesos" [style]="{'width':'160px'}" sortable="custom" [sortable]="true">
            <ng-template pTemplate="body" let-dataset="rowData">
                {{dataset.tracking_summary.total}}
            </ng-template>
        </p-column>
        <p-column field="lastUpdate" header="Última actualización" [style]="{'width':'220px'}" sortable="custom" [sortable]="true">
            <ng-template pTemplate="body" let-dataset="rowData">
                {{dataset.metadata_modified | date: 'dd/MM/yyyy'}}
            </ng-template>
        </p-column>
    </p-dataTable>
    <p-paginator rows="{{pageRows}}" totalRecords="{{numDatasets}}" (onPageChange)="paginate($event)"></p-paginator>
    <div class="nota">
        <p>
            <i class="fa fa-star" id="informacion_content_3_i" style="color: #5ea2ba;"></i> Se ha accedido al conjunto de
            datos más de 10 veces en los últimos 14 días.
        </p>
    </div>
    <div class="destacado" style="width: 100%;">
        <h1>Datos destacados</h1>
        <h3 style="color: grey">Permítenos recomendarte algunos datos abiertos</h3>
        <div class="ui-g ">
            <div class="ui-sm-12 ui-lg-4">
                <div class="box">
                    <div class="boxTitle">
                        <h3>NUEVOS DATOS</h3>
                    </div>
                    <div class="boxContent">
                        <div>
                            <div *ngFor="let newDataset of newestDatasets">
                                <a routerLink='/datos/catalogo/{{newDataset.name}}' (click)="showDataset(newDataset)" class="textosNormales">
                                    {{newDataset.title}}
                                </a>
                                <div *ngIf="newestDatasets.indexOf(newDataset) != 2" class="separadorVentana"></div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="ui-sm-12 ui-lg-4">
                <div class="box">
                    <div class="boxTitle">
                        <h3>MÁS DESCARGADOS</h3>
                    </div>
                    <div class="boxContent">
                        <div>
                            <div *ngFor="let downloadedDataset of downloadedDatasets">
                                <a routerLink='/datos/catalogo/{{downloadedDataset.name}}' (click)="showDataset(downloadedDataset)" class="textosNormales">
                                    {{downloadedDataset.title}}
                                </a>
                                <div *ngIf="downloadedDatasets.indexOf(downloadedDataset) != 2" class="separadorVentana"></div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="ui-sm-12 ui-lg-4">
                <div class="box">
                    <div class="boxTitle">
                        <h3>ESTADÍSTICAS</h3>
                    </div>
                    <div class="boxContent">
                        <div>
                            <h6>Número de datasets</h6>
                            <p class="counter">{{datasetCount}}</p>
                        </div>
                        <div class="separadorVentana"></div>
                        <div>
                            <h6>Número de recursos</h6>
                            <img src="../../../assets/numResources.png" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>