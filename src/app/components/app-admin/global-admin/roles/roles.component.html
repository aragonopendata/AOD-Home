<div style="padding: 2%;">
  <p-dataTable [value]="roles" [paginator]="true" rows="15" [responsive]="true">
    <p-column field="roleName" header="Nombre" [sortable]="true"></p-column>
    <p-column field="description" header="Rol" [sortable]="true"></p-column>
    <p-column header="Usuarios asignados" [sortable]="true">
      <ng-template let-role="rowData" let-ri="rowIndex" pTemplate="body">
        <span>{{roles[ri].assignedUsers.length}}</span>
        <button pButton type="button" icon="fa-search" (click)="showUsers(role)"></button>
      </ng-template>
    </p-column>
    <p-column header="Edición">
      <ng-template pTemplate="body" let-role="rowData">
        <button pButton type="button" icon="fa-search" (click)="showDialog(role, true)"></button>
        <button pButton type="button" icon="fa-edit" (click)="showDialog(role, false)"></button>
        <button pButton type="button" icon="fa-trash"></button>
      </ng-template>
    </p-column>
    <p-footer>
      <div class="ui-helper-clearfix" style="width:100%">
        <button type="button" pButton icon="fa-plus" style="float:left" (click)="showDialogToAdd()" label="Añadir"></button>
      </div>
    </p-footer>
  </p-dataTable>
</div>

<p-dialog *ngIf="role" appendTo="body" header="Usuarios asignados" [(visible)]="displayUsers" [responsive]="true" showEffect="fade" modal="true">
  <div *ngFor="let user of role.assignedUsers" style="text-align: center;">
    {{user.username}}<br/>
  </div>
</p-dialog>

<p-dialog appendTo="body" header="Detalles del rol" [(visible)]="displayDialog" [responsive]="true" showEffect="fade" modal="true">
  <div class="ui-grid ui-grid-responsive ui-fluid" *ngIf="role">
    <div class="ui-grid-row" style="padding: 5px;">
      <div class="ui-grid-col-4"><label for="roleName">Nombre de usuario</label></div>
      <div class="ui-grid-col-8"><input pInputText id="roleName" [disabled]="disabled" [(ngModel)]="role.roleName" /></div>
    </div>
    <div class="ui-grid-row" style="padding: 5px;">
      <div class="ui-grid-col-4"><label for="description">Rol</label></div>
      <div class="ui-grid-col-8"><input pInputText id="description" [disabled]="disabled" [(ngModel)]="role.description" /></div>
    </div>
  </div>
  <p-footer>
    <div class="ui-dialog-buttonpane ui-helper-clearfix">
      <button type="button" pButton icon="fa-check" [disabled]="disabled" label="Guardar"></button>
      <button type="button" pButton icon="fa-edit" [disabled]="!disabled" (click)="enableEdition()" label="Editar"></button>
    </div>
  </p-footer>
</p-dialog>